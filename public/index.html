<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="/socket.io/socket.io.js"></script>
    <!-- <script src="./js/chat.js"></script> -->

    <title>Document</title>
    <!-- CSS only -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <style>
      .container {
        max-width: 955px;
        background-color: aqua;
        margin: auto;
        max-height: 85vh;
        overflow-y: auto;
        box-shadow: rgba(0, 0, 0, 0.8) 0 0 10px;
      }
      .message {
        background-color: grey;
        width: 30%;
        padding: 3px;
        margin-left: 3px;
        border-radius: 10px;
        margin-bottom: 3px;
        box-shadow: rgba(0, 0, 0, 0.8) 0 0 10px;
        margin-bottom: 20px;
      }
      .left {
        float: left;
        clear: both;
      }
      .right {
        float: right;
        clear: both;
      }
      .send {
        text-align: center;
        margin-top: 50px;
        max-width: 959px;
        display: block;
        margin: auto;
      }

      #sendmessage {
        width: 90%;

        box-shadow: rgba(0, 0, 0, 0.8) 0 0 10px;
      }
    </style>
    <div class="container mt-5 text-white">
      <div class="logo text-center mt-2 mb-2 text-dark">
        should display logo
      </div>
      <div class="message left text-start mt-2">
        This is message from the other person Lorem ipsum dolor sit amet
        consectetur adipisicing elit. Molestiae excepturi sit quasi quaerat id
        assumenda, laudantium consequatur doloribus eaque soluta suscipit
        laborum similique vero fuga culpa cum debitis natus possimus.
      </div>
      <div class="message right">This is me</div>
      <div class="message right">This is me</div>
      <div class="message right">This is me</div>
      <div class="message right">This is me</div>
    </div>
    <div class="send">
      <form class="input-group" id="sendform">
        <input
          type="text"
          id="sendmessage"
          placeholder="Write message here"
          autofocus
        />
        <button class="btn bg-dark text-white" style="width: 10%">Send</button>
      </form>
    </div>
    <script>
      const form = document.querySelector(".input-group");
      const messageInput = document.getElementById("sendmessage");
      const messageContainer = document.querySelector(".container");
      const messageLeft = document.querySelector(".message left");
      const messageRight = document.querySelector(".message right");
      const append = (message, position) => {
        const messageElement = document.createElement("div");
        messageElement.innerText = message;
        messageElement.classList.add("message");
        messageElement.classList.add(position);
        messageContainer.append(messageElement);
      };

      var audio = new Audio("../ting.mp3");
      const socket = io();
      let textMessage;
      document.querySelector("#sendform").addEventListener("submit", (e) => {
        e.preventDefault();
        textMessage = document.querySelector("input").value;
        textMessage = textMessage.trim();
        if (textMessage === "") {
        } else {
          textMessage = textMessage;
          append(textMessage, "right");
          socket.emit("inputMessage", textMessage);
          messageContainer.scrollTop = messageContainer.scrollHeight;
          audio.play();
        }

        clearMessage();
        messageLeft.scrollTop = messageLeft.scrollHeight;
        messageRight.scrollTop = messageRight.scrollHeight;
      });

      const clearMessage = () => {
        document.querySelector("input").value = "";
      };

      socket.on("takeMessage", (text) => {
        append(text, "left");
      });
    </script>

    <!-- <script defer src="../chat.js"></script> -->
  </body>
</html>
